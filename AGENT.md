# AGENT.md - Codex専用開発指示書

このファイルはCodex MCPエージェント専用の指示書です。

## 🚨 最重要指示

**必ず以下の手順に従ってください：**

1. **ルールファイルを必読**: 作業開始前に`agent-rules/`配下の該当ルールファイルをすべて読み込む
2. **優先順位を遵守**: 番号が大きいファイルのルールを優先する
3. **絶対原則を厳守**: 00-core-principles.mdの内容は他のすべてより優先

## Codex対象ルールファイル一覧

以下のルールファイルを**必ず読み込んで遵守**してください：

### レイヤー0: 基盤原則【🔴 絶対最優先】
- **`agent-rules/00-core-principles.md`**: 絶対原則（デグレ防止、日本語使用、TDD）
- **`agent-rules/02-development-workflow.md`**: 開発フロー基本原則

### レイヤー1: ワークフロー【🔴 Codex専用・必須遵守】
- **`agent-rules/10-git-strategy.md`**: Git戦略（ブランチ管理、コミット規約）
- **`agent-rules/11-testing-strategy.md`**: テスト戦略（TDD実践方法）
- **`agent-rules/12-security-guidelines.md`**: セキュリティ原則（機密情報保護）

### レイヤー3: 品質保証【🔴 Codex専用・必須遵守】
- **`agent-rules/50-production-reliability.md`**: プロダクション信頼性（エラーハンドリング、防御的プログラミング）

### レイヤー4: 環境固有【🔴 Codex専用・必須遵守】
- **`agent-rules/70-docker-environments.md`**: Docker環境管理

## 基本動作原則

### 1. 作業開始時の必須手順
```bash
# 1. ルールファイルを読み込む（必須）
# agent-rules/配下の上記ファイルをすべて読み取り、内容を理解する

# 2. 現在のブランチ状況を確認
git branch
git status

# 3. developmentブランチで作業開始
git checkout develop
git checkout -b development/feature/task-name
```

### 2. 開発中の必須要件
- **TDD実践**: テストファーストでの開発（11-testing-strategy.md参照）
- **アトミックコミット**: 1コミット=1変更（10-git-strategy.md参照）
- **日本語での記述**: コメント・エラーメッセージ・コミットメッセージ（00-core-principles.md参照）
- **防御的プログラミング**: すべての入力に対して安全なコード（50-production-reliability.md参照）

### 3. 完了前の必須チェック
- [ ] 該当するすべてのルールファイルの内容に従っている
- [ ] すべてのテストが通過している
- [ ] 既存機能に影響していない（デグレ防止）
- [ ] セキュリティガイドラインを遵守している

## 優先順位

**矛盾が生じた場合の解決順序：**
1. **00-core-principles.md** が最優先（絶対原則）
2. **番号の大きいルールファイル** を優先
3. **Codex専用ルール** を一般ルールより優先
4. **このAGENT.md** の内容よりルールファイルを優先

## 緊急時の対応

### ルールファイル読み込み失敗時
1. エラー内容をClaudeに報告
2. 作業を一時停止
3. 指示を待つ

### ルール間の矛盾発見時
1. 番号の大きいファイルを優先
2. 判断困難な場合はClaudeに相談
3. 決定事項を文書化

---

**重要**: このAGENT.mdは参照指示書です。具体的なルールの詳細は各ルールファイルに記載されています。作業前に必ず該当ルールファイルをすべて読み込み、その内容に従って作業してください。