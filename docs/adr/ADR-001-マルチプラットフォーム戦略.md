# ADR-001: マルチプラットフォーム戦略

**ステータス:** 承認済み
**日付:** 2025-09-25
**意思決定者:** 開発チーム

## コンテキスト

myJarvisプロジェクトは、iPhoneとWebアプリの両方で一貫したユーザー体験を提供する必要があります。開発効率、メンテナンス性、そして各プラットフォームの特性を最大限に活かすための最適な技術選定が求められます。特に、ビジネスロジック（スケジューリング、データ処理）の共通化と、UI/UXの最適化が重要な課題となります。

## 検討した選択肢

### 1. フルネイティブ開発
- **概要**: iOSはSwift/SwiftUI、WebはReact/Vue/Angularで個別に開発
- **長所**:
  - 各プラットフォームで最高のパフォーマンスとUI/UXを実現
  - プラットフォーム固有機能への完全なアクセス
- **短所**:
  - 開発コストと時間が2倍
  - ロジックの共通化が困難
  - 機能追加や修正の際に両方のコードをメンテナンス

### 2. クロスプラットフォームフレームワーク
- **概要**: React Native / Flutter で一つのコードベースから両方をビルド
- **長所**:
  - 開発速度が速い
  - コードの大部分を共通化可能
- **短所**:
  - プラットフォーム固有機能への制限
  - ネイティブほどのパフォーマンスやUIの忠実性に制限
  - Web対応がまだ発展途上

### 3. 共有コア + ネイティブUI
- **概要**: Kotlin Multiplatform / Rust でビジネスロジックを共通化、UI層は各プラットフォームでネイティブ実装
- **長所**:
  - ビジネスロジックの共通化とネイティブUI体験の両立
  - 複雑なスケジューリングやML処理の一貫性確保
- **短所**:
  - 初期設定の複雑さ
  - 共有コアとネイティブUI間のブリッジング知識が必要

## 決定

**「共有コア + ネイティブUI」アプローチを採用し、Kotlin Multiplatform (KMP)でビジネスロジックを開発、UIはiOSでSwiftUI、WebでReactで個別開発します。**

### 決定理由

1. **ロジックの共通化**: スケジューリング最適化、タスク分解、データ連携といった複雑なロジックを一度の実装で品質と一貫性を保証
2. **ネイティブUI/UX**: 各プラットフォームに最適化されたネイティブ技術でUIを構築し、最高の操作性を実現
3. **ローカルMLとの親和性**: MLモデルのロジックをKMPの共通コアに組み込み、iOSとWebで同一の推論結果を保証

## 影響と結果

### ポジティブな影響
- 長期的なメンテナンスコストの大幅削減
- ビジネスロジックの修正のみで両プラットフォーム対応可能
- コード品質と一貫性の向上

### ネガティブな影響
- 開発チームにKotlin、SwiftUI、React技術のスキルセット要求
- 初期のプロジェクトセットアップとビルド環境構築の学習コスト
- アーキテクチャの複雑性増加

### 実装に必要な技術要素
- Kotlin Multiplatform Mobile (KMM)
- iOS: SwiftUI + Swift Package Manager
- Web: React + TypeScript
- 共通のデータモデルとAPI定義
- プラットフォーム間のインターフェース設計

## 関連する意思決定
- ADR-003: AI/MLパイプライン設計（ローカルML実行）
- ADR-005: データストレージ・プライバシー戦略（クライアント側データ管理）